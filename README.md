# Factors Explaining Response or Non-Response to tDCS in Patients with Epilepsy: A Computational Modeling Study #

#### This repository contains the computational modeling scripts and data processing pipelines associated with the paper submitted to the Journal of Neural Engineering. ####

#### Abstract

**Rationale**: Interictal epileptiform discharges (IEDs) are key pathological neuromarkers generated by epileptogenic networks (ENs). A number of studies have shown that transcranial Direct Current Stimulation (tDCS) may reduce the rate of IEDs but the biophysical and neurophysiological factors that influence its efficacy remain unclear.

**Objective**: This study aims at building a comprehensive whole-brain computational modeling framework to examine three factors that intervene in the efficacy of tDCS: (i) the EN location, (ii) the EN spatial extension and (iii) the tDCS montage (bipolar, HD-tDCS, multielectrode).

**Methods**: We propose a novel pipeline for computing tDCS-induced electric fields (E-Fields) in a neuro-inspired whole-brain model. This model consists of 246 interconnected brain regions, each being modeled by a neural mass model that accounts for the acute effects of E-Fields (with a weak magnitude of 0.25 V/m) and the lasting effects of neuroplasticity mechanisms (long-term depression and potentiation).

**Results**: Across all EN scenarios, the multielectrode montage achieved the greatest suppression of IEDs and the highest reduction of functional connectivity in the EN. In deeper and more extended ENs, the conventional bipolar tDCS montage was outperformed by the multielectrode and HD-tDCS montages which achieved more focal stimulation of the EN targets.

**Conclusion**: This is the first whole-brain computational modeling study designed to systematically examine how the efficacy of tDCS varies with the montage, the cortical extent, and the depth of ENs. The modeling pipeline could inform future clinical studies in which tDCS is a potential therapeutic strategy.

**Keywords**: tDCS, whole-brain modeling, neural mass model, epilepsy, interictal-epileptiform discharge, neuroplasticity

<img width="1280" height="720" alt="Figure 3" src="https://github.com/user-attachments/assets/74996fdc-775e-4d73-8ab3-c5dd5cc2b71c" />



### Repository Structure

The codebase is organized into three main directories:

src/ (Source Code)

Contains the core logic for the Neural Mass Model (NMM) and simulation execution.

* whole_brain_simulation.py: The main entry point. Simulates the 246-node whole-brain network, applies tDCS stimulation weighted by E-normals, computes plasticity, and exports results as .edf file and basic plots.

* model_ecoalia_legacy_optimized.py: Neural Mass Model. It includes specific dynamics for Pyramidal, PV, and SST interneuron populations, as well as plasticity mechanisms (see: Koksal-Ersoz et al. *Expansion of epileptogenic networks via neuroplasticity in neural mass models* Plos Computational Biology 2024 https://doi.org/10.1371/journal.pcbi.1012666).

* EZ_PZ_minimal_network.py: A minimal 2-node proof-of-concept (Epileptogenic Zone -> Propagation Zone) to demonstrate the plasticity and stimulation dynamics in isolation.

* parameters_*.py: Configuration files defining the biophysical parameters for the Whole Brain, EZ, and PZ regions.

* generate_whole_brain_params.py: Parsers legacy simulation text files to generate Python-compatible parameter modules.

* average_enormals_rois.py: Maps tDCS E-field vectors from a cortex mesh (.vtk) to specific Regions of Interest (ROIs), calculating the average E-normal per node.

data/ (Input Assets)

* CMs/: Connectivity matrices (.mat).

* region_names_and_scouts/: Atlas definitions and region names.

* cortex_mesh.vtk: Head model mesh used for E-field calculation.

* roi_averaged_enormals.txt: Computed E-field sensitivity for each of the 246 brain regions.

Installation

This project relies on Python 3 and standard scientific computing libraries. It uses Numba for JIT compilation to accelerate the differential equation solvers.

pip install numpy scipy pandas matplotlib numba mne 


Usage

1. Running the Whole-Brain Simulation

scenario NE2LOC1 with 1 EZ connected to 10 PZs, stimulated by tDCS bipolar montage (BIP):

python src/whole_brain_simulation.py

Output:

whole_brain_simulation_results.png: A figure showing the LFP traces for the EZ and PZ, alongside calcium concentration and AMPA receptor state evolution.

whole_brain_LFP.edf: Containing the simulated Local Field Potentials for all 246 regions.

2. Running the minimal network simulation (EZ->PZ):

To test the plasticity dynamics on a simple 2-node network:

python src/EZ_PZ_minimal_network.py

<img width="789" height="607" alt="Figure 8" src="https://github.com/user-attachments/assets/ee7d3305-9789-4a7e-805b-033d197b9f80" />

